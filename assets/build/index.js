!function(e){var t={};function n(a){if(t[a])return t[a].exports;var l=t[a]={i:a,l:!1,exports:{}};return e[a].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(a,l,function(t){return e[t]}.bind(null,l));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=window.moment},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,n.apply(this,arguments)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=window.wp.apiFetch},function(e,t,n){"use strict";n.r(t);var a=n(5),l=n.n(a),r=n(3),o=n.n(r),i=n(0),s=n(1),c=n(6),u=n.n(c),d=n(2),m=n(4),p=n.n(m);const{applyFilters:b}=wp.hooks;class O extends i.Component{constructor(e){super(e),o()(this,"setOpen",e=>{this.setState({isOpen:e})}),o()(this,"closeModal",()=>{this.setOpen(!1)}),this.state={isOpen:!0,isLoading:!0,total_read_count:0,total_link_click_count:0,to:"",subject:"",message:"",message_plain:"",headers:"",attachments:"",date_time:"",read_log:[],link_click_log:[]}}componentDidMount(){u()({path:"/email-tracker/v1/email/"+this.props.id+"/",method:"GET"}).then(e=>{this.setState({...e,isLoading:!1})},e=>{this.setState({isLoading:!1}),alert("Error in fetching notes list with the message: "+e.message+"("+e.code+")")})}render(){const{id:e,to:t,subject:n}=this.props,a=sprintf(Object(d.__)(" Sub.: %s","email-tracker"),n),r={icon:Object(i.createElement)(s.Dashicon,{icon:"email-alt"}),focusOnMount:!0,isDismissible:!0,shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!0,title:a};let o;if(this.state.isLoading)o=Object(i.createElement)(s.Spinner,{color:"blue",size:"200"});else{const e=p.a.utc(this.state.date_time).local();let t;t=this.state.read_log.length?Object(i.createElement)(s.PanelRow,null,Object(i.createElement)("ol",null,this.state.read_log.map(e=>{let t=p.a.utc(e.date_time).local();return Object(i.createElement)("li",null,sprintf(Object(d.__)("Read at %s on IP %s","email-tracker"),t.format("MMMM Do YYYY, dddd, h:mm:ss a")+" ("+t.fromNow()+")",e.ip_address))}))):Object(d.__)("N/A","email-tracker");let n=this.state,a=b("email-tracker-view-email-extra-panel",null,n);o=Object(i.createElement)(i.Fragment,null,Object(i.createElement)(s.Panel,{header:Object(d.__)("Email Receiver Activity Log","email-tracker")},Object(i.createElement)(s.PanelBody,{title:"#"+sprintf(Object(d._n)("%d time read","%d times read",parseInt(this.state.total_read_count),"email-tracker"),this.state.total_read_count),initialOpen:!!this.state.read_log.length},t),a),Object(i.createElement)("br",null),Object(i.createElement)(s.Panel,{header:"Email Data"},Object(i.createElement)(s.PanelBody,{title:"To",initialOpen:!0},Object(i.createElement)(s.PanelRow,null,this.state.to)),Object(i.createElement)(s.PanelBody,{title:"Send Date Time",initialOpen:!0},Object(i.createElement)(s.PanelRow,null,e.format("MMMM Do YYYY, dddd, h:mm:ss a")," (",e.fromNow(),")")),this.state.headers&&Object(i.createElement)(s.PanelBody,{title:"Headers",initialOpen:!0},Object(i.createElement)(s.PanelRow,null,this.state.headers)),this.state.attachments&&Object(i.createElement)(s.PanelBody,{title:"Attachments",initialOpen:!0},Object(i.createElement)(s.PanelRow,null,this.state.attachments.split(",\\n").map(e=>{let t=email_tracker.content_url+e,n=e.split("/");return Object(i.createElement)(i.Fragment,null,Object(i.createElement)("a",{href:t,target:"_blank"},n[n.length-1]))}))),Object(i.createElement)(s.PanelBody,{title:"Message",initialOpen:!0},Object(i.createElement)(s.PanelRow,null,Object(i.createElement)("div",{dangerouslySetInnerHTML:{__html:this.state.message}})))),Object(i.createElement)("br",null),Object(i.createElement)(s.Button,{isDestructive:!0,isSmall:!0,onClick:this.closeModal},Object(d.__)("Close","email-tracker")))}return Object(i.createElement)(i.Fragment,null,this.state.isOpen&&Object(i.createElement)(s.Modal,l()({},r,{style:{minWidth:"75%"},onRequestClose:this.closeModal}),o))}}window.EMTRLoadView=function(e,t="",n=""){let a={id:e,subject:t,to:n};const l=document.getElementById("emtr-email-view-modal-container");return Object(i.unmountComponentAtNode)(l),Object(i.render)(Object(i.createElement)(O,a),l),!1}}]);