!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.React},function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=window.moment},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,n.apply(this,arguments)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=window.wp.apiFetch},function(e,t,n){"use strict";(function(e){var r=n(2),a=n.n(r),i=n(9),o=n.n(i);function c(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e){var t=e.attributes,n=void 0===t?{}:t,r=e.children,i=void 0===r?null:r,o=e.selfClose,c=void 0!==o&&o,s=e.tagName;return c?a.a.createElement(s,n):a.a.createElement(s,n,i)}var u=function(){function e(){}var t=e.prototype;return t.attribute=function(e,t){return t},t.node=function(e,t){return t},e}(),p={a:{content:9,self:!1,type:105},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:9,void:!0},body:{content:127},button:{content:8,type:105},caption:{content:1,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:97},dd:{content:1,parent:["dl"]},dl:{children:["dt","dd"],type:1},dt:{content:1,invalid:["footer","header"],parent:["dl"]},figcaption:{content:1,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:1,void:!0},img:{void:!0},li:{content:1,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:1},picture:{children:["source","img"],type:25},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:8,parent:["ruby","rtc"]},rtc:{content:8,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:8,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:1},tbody:{parent:["table"],children:["tr"]},td:{content:1,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:1,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:1},video:{children:["track","source"]},wbr:{type:9,void:!0}};function h(e){return function(t){p[t]=l({},e,p[t])}}["address","main","div","figure","p","pre"].forEach(h({content:1,type:65})),["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(h({content:8,type:73})),["p","pre"].forEach(h({content:8,type:65})),["s","small","span","del","ins"].forEach(h({content:8,type:9})),["article","aside","footer","header","nav","section","blockquote"].forEach(h({content:1,type:67})),["h1","h2","h3","h4","h5","h6"].forEach(h({content:8,type:69})),["audio","canvas","iframe","img","video"].forEach(h({type:89}));var f=Object.freeze(p),m=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],b=Object.keys(f).filter((function(e){return"canvas"!==e&&"iframe"!==e})),v=Object.freeze({alt:1,cite:1,class:1,colspan:3,controls:4,datetime:1,default:4,disabled:4,dir:1,height:1,href:1,id:1,kind:1,label:1,lang:1,loading:1,loop:4,media:1,muted:4,poster:1,role:1,rowspan:3,scope:1,sizes:1,span:3,start:3,style:5,src:1,srclang:1,srcset:1,target:1,title:1,type:1,width:1}),y=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet"}),g=/(url|image|image-set)\(/i,O=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),r.prototype.attribute=function(e,t){return"style"===e&&Object.keys(t).forEach((function(e){String(t[e]).match(g)&&delete t[e]})),t},r}(u),w=/^<(!doctype|(html|head|body)(\s|>))/i,E=/^(aria\x2D|data\x2D|[0-9A-Z_a-z\u017F\u212A]+:)/i,j=/{{{(\w+)\/?}}}/;function x(){if("undefined"!=typeof window&&"undefined"!=typeof document)return document.implementation.createHTMLDocument("Interweave")}var k=function(){function t(e,t,n,r){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===r&&(r=[]),this.allowed=void 0,this.banned=void 0,this.blocked=void 0,this.container=void 0,this.content=[],this.props=void 0,this.matchers=void 0,this.filters=void 0,this.keyIndex=void 0,this.props=t,this.matchers=n,this.filters=[].concat(r,[new O]),this.keyIndex=-1,this.container=this.createContainer(e||""),this.allowed=new Set(t.allowList||b),this.banned=new Set(m),this.blocked=new Set(t.blockList)}var n=t.prototype;return n.applyAttributeFilters=function(e,t){return this.filters.reduce((function(t,n){return null!==t&&"function"==typeof n.attribute?n.attribute(e,t):t}),t)},n.applyNodeFilters=function(e,t){return this.filters.reduce((function(t,n){return null!==t&&"function"==typeof n.node?n.node(e,t):t}),t)},n.applyMatchers=function(e,t){var n=this,r={},a=this.props,i=e,o=0,s=null;return this.matchers.forEach((function(e){var d=e.asTag().toLowerCase(),u=n.getTagConfig(d);if(!a[e.inverseName]&&n.isTagAllowed(d)&&n.canRenderChild(t,u)){for(var p="";i&&(s=e.match(i));){var h=s,f=h.index,m=h.length,b=h.match,v=h.valid,y=h.void,g=c(h,["index","length","match","valid","void"]),O=e.propName+o;f>0&&(p+=i.slice(0,f)),v?(p+=y?"{{{"+O+"/}}}":"{{{"+O+"}}}"+b+"{{{/"+O+"}}}",n.keyIndex+=1,o+=1,r[O]={children:b,matcher:e,props:l({},a,g,{key:n.keyIndex})}):p+=b,e.greedy?(i=p+i.slice(f+m),p=""):i=i.slice(f+(m||b.length))}e.greedy||(i=p+i)}})),0===o?e:this.replaceTokens(i,r)},n.canRenderChild=function(e,t){return!(!e.tagName||!t.tagName)&&!e.void&&(e.children.length>0?e.children.includes(t.tagName):!(e.invalid.length>0&&e.invalid.includes(t.tagName))&&(t.parent.length>0?t.parent.includes(e.tagName):!(!e.self&&e.tagName===t.tagName)&&Boolean(e&&e.content&t.type)))},n.convertLineBreaks=function(e){var t=this.props,n=t.noHtml,r=t.disableLineBreaks;if(n||r||e.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return e;var a=e.replace(/\r\n/g,"\n");return(a=a.replace(/\n{3,}/g,"\n\n\n")).replace(/\n/g,"<br/>")},n.createContainer=function(t){var n=(void 0!==e&&e.INTERWEAVE_SSR_POLYFILL||x)();if(n){var r=this.props.containerTagName||"body",a="body"===r||"fragment"===r?n.body:n.createElement(r);return t.match(w)||(a.innerHTML=this.convertLineBreaks(this.props.escapeHtml?o()(t):t)),a}},n.extractAttributes=function(e){var t=this,n=this.props.allowAttributes,r={},a=0;return 1===e.nodeType&&e.attributes?(Array.from(e.attributes).forEach((function(i){var o=i.name,c=i.value,s=o.toLowerCase(),l=v[s]||v[o];if(t.isSafe(e)&&(s.match(E)||(n||l&&2!==l)&&!s.startsWith("on")&&!c.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i))){var d="style"===s?t.extractStyleAttribute(e):c;4===l?d=!0:3===l?d=Number.parseFloat(String(d)):5!==l&&(d=String(d)),r[y[s]||s]=t.applyAttributeFilters(s,d),a+=1}})),0===a?null:r):null},n.extractStyleAttribute=function(e){var t={};return Array.from(e.style).forEach((function(n){var r=e.style[n];"string"!=typeof r&&"number"!=typeof r||(t[n.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))]=r)})),t},n.getTagConfig=function(e){var t={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return f[e]?l({},t,f[e],{tagName:e}):t},n.isSafe=function(e){if("undefined"!=typeof HTMLAnchorElement&&e instanceof HTMLAnchorElement){var t=e.getAttribute("href");if(t&&"#"===t.charAt(0))return!0;var n=e.protocol.toLowerCase();return":"===n||"http:"===n||"https:"===n||"mailto:"===n||"tel:"===n}return!0},n.isTagAllowed=function(e){return!this.banned.has(e)&&!this.blocked.has(e)&&(this.props.allowElements||this.allowed.has(e))},n.parse=function(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]},n.parseNode=function(e,t){var n=this,r=this.props,i=r.noHtml,o=r.noHtmlExceptMatchers,c=r.allowElements,s=r.transform,u=[],p="";return Array.from(e.childNodes).forEach((function(e){if(1===e.nodeType){var r=e.nodeName.toLowerCase(),h=n.getTagConfig(r);p&&(u.push(p),p="");var f,m=n.applyNodeFilters(r,e);if(!m)return;if(s){n.keyIndex+=1;var b=n.keyIndex;f=n.parseNode(m,h);var v=s(m,f,h);if(null===v)return;if(void 0!==v)return void u.push(a.a.cloneElement(v,{key:b}));n.keyIndex=b-1}if(n.banned.has(r))return;if(i||o&&"br"!==r||!n.isTagAllowed(r)||!c&&!n.canRenderChild(t,h))u=u.concat(n.parseNode(m,h.tagName?h:t));else{n.keyIndex+=1;var y=n.extractAttributes(m),g={tagName:r};y&&(g.attributes=y),h.void&&(g.selfClose=h.void),u.push(a.a.createElement(d,l({},g,{key:n.keyIndex}),f||n.parseNode(m,h)))}}else if(3===e.nodeType){var O=i&&!o?e.textContent:n.applyMatchers(e.textContent||"",t);Array.isArray(O)?u=u.concat(O):p+=O}})),p&&u.push(p),u},n.replaceTokens=function(e,t){if(!e.includes("{{{"))return e;for(var n=[],r=e,a=null;a=r.match(j);){var i=a,o=i[0],c=i[1],s=a.index,l=o.includes("/");s>0&&(n.push(r.slice(0,s)),r=r.slice(s));var d=t[c],u=d.children,p=d.matcher,h=d.props,f=void 0;if(l)f=o.length,n.push(p.createElement(u,h));else{var m=r.match(new RegExp("{{{/"+c+"}}}"));f=m.index+m[0].length,n.push(p.createElement(this.replaceTokens(r.slice(o.length,m.index),t),h))}r=r.slice(f)}return r.length>0&&n.push(r),0===n.length?"":1===n.length&&"string"==typeof n[0]?n[0]:n},t}();function _(e){var t,n=e.attributes,r=e.containerTagName,i=e.content,o=e.emptyContent,c=e.parsedContent,s=e.tagName,l=r||s||"div",u="fragment"===l||e.noWrap;if(c)t=c;else{var p=new k(i||"",e).parse();p.length>0&&(t=p)}return t||(t=o),u?a.a.createElement(a.a.Fragment,null,t):a.a.createElement(d,{attributes:n,tagName:l},t)}t.a=function(e){var t=e.attributes,n=e.content,r=void 0===n?"":n,i=e.disableFilters,o=void 0!==i&&i,s=e.disableMatchers,l=void 0!==s&&s,d=e.emptyContent,u=void 0===d?null:d,p=e.filters,h=void 0===p?[]:p,f=e.matchers,m=void 0===f?[]:f,b=e.onAfterParse,v=void 0===b?null:b,y=e.onBeforeParse,g=void 0===y?null:y,O=e.tagName,w=void 0===O?"span":O,E=e.noWrap,j=void 0!==E&&E,x=c(e,["attributes","content","disableFilters","disableMatchers","emptyContent","filters","matchers","onAfterParse","onBeforeParse","tagName","noWrap"]),N=l?[]:m,C=o?[]:h,P=g?[g]:[],A=v?[v]:[];N.forEach((function(e){e.onBeforeParse&&P.push(e.onBeforeParse.bind(e)),e.onAfterParse&&A.push(e.onAfterParse.bind(e))}));var M=P.reduce((function(t,n){return n(t,e)}),r||""),T=new k(M,x,N,C),S=A.reduce((function(t,n){return n(t,e)}),T.parse());return a.a.createElement(_,{attributes:t,containerTagName:e.containerTagName,emptyContent:u,tagName:w,noWrap:j,parsedContent:0===S.length?void 0:S})}}).call(this,n(11))},function(e,t,n){"use strict";var r=/["'&<>]/;e.exports=function(e){var t,n=""+e,a=r.exec(n);if(!a)return n;var i="",o=0,c=0;for(o=a.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}c!==o&&(i+=n.substring(c,o)),c=o+1,i+=t}return c!==o?i+n.substring(c,o):i}},function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),i=n(4),o=n.n(i),c=n(0),s=n(1),l=n(7),d=n.n(l),u=n(3),p=n(5),h=n.n(p),f=n(8);const{applyFilters:m}=wp.hooks;class b extends c.Component{constructor(e){super(e),o()(this,"setOpen",e=>{this.setState({isOpen:e})}),o()(this,"closeModal",()=>{this.setOpen(!1)}),this.state={isOpen:!0,isLoading:!0,total_read_count:0,total_link_click_count:0,to:"",subject:"",message:"",message_plain:"",headers:"",attachments:"",date_time:"",read_log:[],link_click_log:[]}}componentDidMount(){d()({path:"/email-tracker/v1/email/"+this.props.id+"/",method:"GET"}).then(e=>{this.setState({...e,isLoading:!1})},e=>{this.setState({isLoading:!1}),alert("Error in fetching notes list with the message: "+e.message+"("+e.code+")")})}render(){const{id:e,to:t,subject:n}=this.props,r=sprintf(Object(u.__)(" Sub.: %s","email-tracker"),n),i={icon:Object(c.createElement)(s.Dashicon,{icon:"email-alt"}),focusOnMount:!0,isDismissible:!0,shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!0,title:r};let o;if(this.state.isLoading)o=Object(c.createElement)(s.Spinner,{color:"blue",size:"200"});else{const e=h.a.utc(this.state.date_time).local();let t;t=this.state.read_log.length?Object(c.createElement)(s.PanelRow,null,Object(c.createElement)("ol",null,this.state.read_log.map(e=>{let t=h.a.utc(e.date_time).local();return Object(c.createElement)("li",null,sprintf(Object(u.__)("Read at %s on IP %s","email-tracker"),t.format("MMMM Do YYYY, dddd, h:mm:ss a")+" ("+t.fromNow()+")",e.ip_address))}))):Object(u.__)("N/A","email-tracker");let n=this.state,r=m("email-tracker-view-email-extra-panel",null,n);o=Object(c.createElement)(c.Fragment,null,Object(c.createElement)(s.Panel,{header:Object(u.__)("Email Receiver Activity Log","email-tracker")},Object(c.createElement)(s.PanelBody,{title:"#"+sprintf(Object(u._n)("%d time read","%d times read",parseInt(this.state.total_read_count),"email-tracker"),this.state.total_read_count),initialOpen:!!this.state.read_log.length},t),r),Object(c.createElement)("br",null),Object(c.createElement)(s.Panel,{header:"Email Data"},Object(c.createElement)(s.PanelBody,{title:"To",initialOpen:!0},Object(c.createElement)(s.PanelRow,null,this.state.to)),Object(c.createElement)(s.PanelBody,{title:"Send Date Time",initialOpen:!0},Object(c.createElement)(s.PanelRow,null,e.format("MMMM Do YYYY, dddd, h:mm:ss a")," (",e.fromNow(),")")),this.state.headers&&Object(c.createElement)(s.PanelBody,{title:"Headers",initialOpen:!0},Object(c.createElement)(s.PanelRow,null,this.state.headers)),this.state.attachments&&Object(c.createElement)(s.PanelBody,{title:"Attachments",initialOpen:!0},Object(c.createElement)(s.PanelRow,null,this.state.attachments.split(",\\n").map(e=>{let t=email_tracker.content_url+e,n=e.split("/");return Object(c.createElement)(c.Fragment,null,Object(c.createElement)("a",{href:t,target:"_blank"},n[n.length-1]))}))),Object(c.createElement)(s.PanelBody,{title:"Message",initialOpen:!0},Object(c.createElement)(s.PanelRow,null,Object(c.createElement)(f.a,{content:this.state.message})))),Object(c.createElement)("br",null),Object(c.createElement)(s.Button,{isDestructive:!0,isSmall:!0,onClick:this.closeModal},Object(u.__)("Close","email-tracker")))}return Object(c.createElement)(c.Fragment,null,this.state.isOpen&&Object(c.createElement)(s.Modal,a()({},i,{style:{minWidth:"75%"},onRequestClose:this.closeModal}),o))}}window.EMTRLoadView=function(e,t="",n=""){let r={id:e,subject:t,to:n};const a=document.getElementById("emtr-email-view-modal-container");return Object(c.unmountComponentAtNode)(a),Object(c.render)(Object(c.createElement)(b,r),a),!1}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}]);